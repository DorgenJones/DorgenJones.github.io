<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('https://dorgenjones.github.io').hostname,
    root: '/',
    scheme: 'Gemini',
    version: '7.7.1',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":true},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Zamperini">
<meta property="og:url" content="https://dorgenjones.github.io/page/11/index.html">
<meta property="og:site_name" content="Zamperini">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Zamperini">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://dorgenjones.github.io/page/11/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false
  };
</script>

  <title>Zamperini</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Zamperini</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>æ ‡ç­¾<span class="badge">23</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>åˆ†ç±»<span class="badge">11</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>å½’æ¡£<span class="badge">56</span></a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dorgenjones.github.io/2017/08/13/%E5%9F%BA%E7%A1%80%E5%B7%A5%E5%85%B7/hystrix/2.hystrix-%E5%AE%9E%E8%B7%B5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avator.png">
      <meta itemprop="name" content="Zamperini">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zamperini">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2017/08/13/%E5%9F%BA%E7%A1%80%E5%B7%A5%E5%85%B7/hystrix/2.hystrix-%E5%AE%9E%E8%B7%B5/" class="post-title-link" itemprop="url">Hystrix-å®è·µ</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2017-08-13 00:00:00" itemprop="dateCreated datePublished" datetime="2017-08-13T00:00:00+08:00">2017-08-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-02-13 20:00:47" itemprop="dateModified" datetime="2020-02-13T20:00:47+08:00">2020-02-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hystrix/" itemprop="url" rel="index">
                    <span itemprop="name">hystrix</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Hystrixä½¿ç”¨"><a href="#Hystrixä½¿ç”¨" class="headerlink" title="Hystrixä½¿ç”¨"></a>Hystrixä½¿ç”¨</h1><p>Hystrixçš„ä½¿ç”¨æ–¹å¼æœ‰ä¸¤ç§ï¼šåŸç”Ÿå’Œæ³¨è§£<br>é¦–å…ˆå¼•å…¥ä¾èµ–<a href="https://github.com/Netflix/Hystrix/blob/master/CHANGELOG.md" target="_blank" rel="noopener">Change Log</a>ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.netflix.hystrix&lt;&#x2F;groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;hystrix-core&lt;&#x2F;artifactId&gt;</span><br><span class="line">    &lt;version&gt;$&#123;hystrix.version&#125;&lt;&#x2F;version&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br><span class="line">&lt;!--å¼•å…¥ Hystrixæ³¨è§£åˆ‡é¢--&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.netflix.hystrix&lt;&#x2F;groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;hystrix-javanica&lt;&#x2F;artifactId&gt;</span><br><span class="line">    &lt;version&gt;$&#123;hystrix.version&#125;&lt;&#x2F;version&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure>

<p>Hystrixæä¾›äº†éå¸¸ä¾¿æ·çš„å°è£… â€“ ä¸¤ä¸ªå¯ç»§æ‰¿çš„æŠ½è±¡ç±»<code>HystrixCommand</code>/<code>HystrixObservableCommand</code>ã€‚åªéœ€ç»§æ‰¿å®ƒä»¬ï¼Œå®ç°<code>run()</code>/<code>construct()</code>æ–¹æ³•ï¼Œåœ¨æ–¹æ³•ä¸­å®ç°å¯¹éœ€è¦éš”ç¦»çš„å¤–éƒ¨ä¾èµ–å’Œé€»è¾‘ï¼Œå³å¯äº«å—Hystrixå¸¦æ¥çš„è¯¸å¤šå¥½å¤„ã€‚<br><code>HystrixCommand</code> æœ‰å››ç§æ–¹æ³•ä¾›ä¸åŒåœºæ™¯éœ€æ±‚ï¼š<code>execute()</code>/<code>queue()</code>/<code>observe()</code>/<code>toObservable()</code> ï¼Œ<code>HystrixObservableCommand</code>æä¾›<code>observe()</code>/<code>toObservable()</code></p>
<ul>
<li>å››ç§æ–¹æ³•çš„åŠŸèƒ½ï¼š<ul>
<li><strong>execute()</strong>ï¼šä»¥åŒæ­¥å µå¡æ–¹å¼æ‰§è¡Œ<code>run()</code></li>
<li><strong>queue()</strong>ï¼šä»¥å¼‚æ­¥éå µå¡æ–¹å¼æ‰§è¡Œ<code>run()</code></li>
<li><strong>observe()</strong>ï¼šäº‹ä»¶æ³¨å†Œå‰æ‰§è¡Œ<code>run()</code>/<code>construct()</code>ã€‚<code>HystrixCommand</code> ä¼šåˆ›å»ºæ–°çº¿ç¨‹éé˜»å¡æ‰§è¡Œ<code>run()</code>ï¼Œ<code>HystrixObservableCommand</code> åˆ™ä¼šåœ¨è°ƒç”¨ç¨‹åºé‡Œæ‰§è¡Œ<code>construct()</code>ã€‚</li>
<li><strong>toObservable()</strong>ï¼šäº‹ä»¶æ³¨å†Œåæ‰§è¡Œ<code>run()</code>/<code>construct()</code>ã€‚è°ƒç”¨<code>toObservable()</code> ä¼šç›´æ¥è¿”å›ä¸€ä¸ªå°±ç›´æ¥è¿”å›ä¸€ä¸ª<code>Observable&lt;R&gt;</code>å¯¹è±¡ï¼Œè€Œä¸å»æ‰§è¡Œã€‚å½“æ‰§è¡Œsubscribeæ—¶ï¼Œæ‰ä¼šå»æ‰§è¡Œé€»è¾‘ <code>run()</code>æ–¹æ³•ä¸­çš„é€»è¾‘æˆ–è€…<code>HystrixObservableCommand</code>ä¸­ <code>constrcut()</code>è¿”å›çš„Observableä¸­çš„é€»è¾‘ã€‚ä¸ä¸Šé¢ä¸€æ ·ï¼Œ<code>HystrixCommand</code>åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œé€»è¾‘ï¼Œè€Œ<code>HystrixObservableCommand</code>ä¼šç›´æ¥ä½¿ç”¨è°ƒç”¨çº¿ç¨‹æ‰§è¡Œã€‚</li>
</ul>
</li>
</ul>
<p>é¦–å…ˆï¼Œæ¥ç®€å•çœ‹ä¸€çœ‹ Hystrixå®˜æ–¹Wikiç»™å‡ºçš„ä¾‹å­ï¼ˆmovie-ocsä¸­çš„ <a href="http://git.sankuai.com/projects/MOVIE/repos/movie-ocs/pull-requests/21/diff#service/src/main/java/com/maoyan/ocs/services/rpc/hystrix/VoucherInfoQueryCommand.java" target="_blank" rel="noopener"><strong>æ”¹åŠ¨</strong></a>ï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommandHelloWorld</span> <span class="keyword">extends</span> <span class="title">HystrixCommand</span>&lt;<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CommandHelloWorld</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        Setter setter = Setter.withGroupKey(</span><br><span class="line">        HystrixCommandGroupKey.Factory.asKey(<span class="string">"helloWorldGroup"</span>))</span><br><span class="line">            .andCommandKey(HystrixCommandKey.Factory.asKey(<span class="string">"helloWorldQuery"</span>)</span><br><span class="line">            .andThreadPoolKey(HystrixThreadPoolKey.Factory.asKey(<span class="string">"helloWorldThreadPollKey"</span>))</span><br><span class="line">            .andCommandPropertiesDefaults(HystrixCommandProperties.Setter()</span><br><span class="line">            .withExecutionIsolationStrategy(THREAD))<span class="comment">//SEMAPHORE</span></span><br><span class="line">            );</span><br><span class="line">        <span class="keyword">super</span>(setter);</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> String <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//å®ç°ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">        System.out.println(<span class="string">"Time:"</span> + System.currentTimeMillis() + <span class="string">"ï¼ŒThread:"</span> +Thread.currentThread().getName());</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello "</span> + name + <span class="string">"!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">UnitTest</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åŒæ­¥æ¨¡å¼è®¿é—®</span></span><br><span class="line">        <span class="meta">@Test</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSynchronous</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            assertEquals(<span class="string">"Hello World!"</span>, <span class="keyword">new</span> CommandHelloWorld(<span class="string">"World"</span>).execute());</span><br><span class="line">            assertEquals(<span class="string">"Hello Bob!"</span>, <span class="keyword">new</span> CommandHelloWorld(<span class="string">"Bob"</span>).execute());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//é˜»å¡æ¨¡å¼çš„å¼‚æ­¥</span></span><br><span class="line">        <span class="meta">@Test</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAsynchronous1</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">            assertEquals(<span class="string">"Hello World!"</span>, <span class="keyword">new</span> CommandHelloWorld(<span class="string">"World"</span>).queue().get());</span><br><span class="line">            assertEquals(<span class="string">"Hello Bob!"</span>, <span class="keyword">new</span> CommandHelloWorld(<span class="string">"Bob"</span>).queue().get());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å¼‚æ­¥</span></span><br><span class="line">        <span class="meta">@Test</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAsynchronous2</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">            Future&lt;String&gt; fWorld = <span class="keyword">new</span> CommandHelloWorld(<span class="string">"World"</span>).queue();</span><br><span class="line">            Future&lt;String&gt; fBob = <span class="keyword">new</span> CommandHelloWorld(<span class="string">"Bob"</span>).queue();</span><br><span class="line">            assertEquals(<span class="string">"Hello World!"</span>, fWorld.get());</span><br><span class="line">            assertEquals(<span class="string">"Hello Bob!"</span>, fBob.get());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//ç›‘å¬æ¨¡å¼</span></span><br><span class="line">        <span class="meta">@Test</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testObservable</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">            Observable&lt;String&gt; fWorld = <span class="keyword">new</span> CommandHelloWorld(<span class="string">"World"</span>).observe();</span><br><span class="line">            Observable&lt;String&gt; fBob = <span class="keyword">new</span> CommandHelloWorld(<span class="string">"Bob"</span>).observe();</span><br><span class="line">            System.out.println(<span class="string">"This Step"</span>);</span><br><span class="line">            <span class="comment">// é˜»å¡</span></span><br><span class="line">            assertEquals(<span class="string">"Hello World!"</span>, fWorld.toBlocking().single());</span><br><span class="line">            assertEquals(<span class="string">"Hello Bob!"</span>, fBob.toBlocking().single());</span><br><span class="line">            <span class="comment">// éé˜»å¡æ¨¡å¼</span></span><br><span class="line">            <span class="comment">// - å†—é•¿çš„åŒ¿åå†…éƒ¨ç±»</span></span><br><span class="line">            fWorld.subscribe(<span class="keyword">new</span> Observer&lt;String&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCompleted</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(String v)</span> </span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">"onNext: "</span> + v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            Time: 1501830396399, Thread: hystrix-ExampleGroup-7</span></span><br><span class="line"><span class="comment">            This Step</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            <span class="comment">//éé˜»å¡æ¨¡å¼ï¼Œçœç•¥äº†å¼‚å¸¸å’ŒonCompletedæ ‡è®°</span></span><br><span class="line">            fBob.subscribe(<span class="keyword">new</span> Action1&lt;String&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(String v)</span> </span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">"onNext: "</span> + v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//ä»…å½“è¢«è®¢é˜…æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œruné‡Œé¢çš„é€»è¾‘</span></span><br><span class="line">        <span class="meta">@Test</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">toObserables</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            Observable&lt;String&gt; kitty = <span class="keyword">new</span> CommandHelloWorld(<span class="string">"Kitty"</span>).toObservable();</span><br><span class="line">            System.out.println(<span class="string">"This Step"</span>);</span><br><span class="line">            kitty.subscribe(<span class="keyword">new</span> Action1&lt;String&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">                    System.out.printf(s);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//è¾“å‡ºç»“æœï¼š</span></span><br><span class="line">        <span class="comment">//This Step</span></span><br><span class="line">        <span class="comment">//Time: 1501830396400, Thread: hystrix-ExampleGroup-8</span></span><br><span class="line">        <span class="comment">//Hello Kitty!</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆšè¯´äº†è¿˜æœ‰ä¸€ç§ç»§æ‰¿ <code>HystrixObservableCommand</code> ï¼Œç›¸å¯¹äº<code>HystrixCommand</code>å®ƒåªæä¾›äº†<code>observe()</code>å’Œ<code>toObservable()</code>æ–¹æ³•ã€‚é‚£ä¹ˆå®ƒå­˜åœ¨çš„æ„ä¹‰æ˜¯å•¥ï¼Ÿ</p>
<h3 id="æ¥çœ‹çœ‹å®ƒä»¬çš„å·®åˆ«ï¼š"><a href="#æ¥çœ‹çœ‹å®ƒä»¬çš„å·®åˆ«ï¼š" class="headerlink" title="æ¥çœ‹çœ‹å®ƒä»¬çš„å·®åˆ«ï¼š"></a>æ¥çœ‹çœ‹å®ƒä»¬çš„å·®åˆ«ï¼š</h3><ul>
<li><p>è¡¨é¢çš„å·®åˆ«ï¼šé™¤äº†åå­—ä¸ä¸€æ ·ï¼Œå‰è€…çš„ä¸šåŠ¡é€»è¾‘å†™åœ¨<code>run()</code>é‡Œï¼Œå¹¶ç›´æ¥è¿”å›ç»“æœï¼›åè€…çš„å‘½ä»¤é€»è¾‘å†™åœ¨<code>construct()</code>è¿”å› <code>Observable&lt;R&gt;</code>;</p>
</li>
<li><p>å‰è€…é»˜è®¤æ˜¯çº¿ç¨‹éš”ç¦»ï¼Œåè€…æ˜¯ä¿¡å·é‡éš”ç¦»ï¼Œæ¢ç§è¯´æ³•ï¼šå‰è€…åœ¨æ–°çš„çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œåè€…æ˜¯è°ƒç”¨çº¿ç¨‹ä¸­æ‰§è¡Œã€‚</p>
</li>
<li><p>å‰è€…ä¸€ä¸ªå®ä¾‹åªèƒ½å‘è°ƒç”¨ç¨‹åºå‘é€å•æ¡ç»“æœæ•°æ®ï¼›åè€…ä¸€ä¸ª<code>Observable</code>, å…¶å¯ä»¥å‘é€å¤šæ¡æ•°æ®ã€‚</p>
</li>
</ul>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2017/08/13/%E5%9F%BA%E7%A1%80%E5%B7%A5%E5%85%B7/hystrix/2.hystrix-%E5%AE%9E%E8%B7%B5/#more" rel="contents">
                é˜…è¯»å…¨æ–‡ &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dorgenjones.github.io/2017/08/12/%E5%9F%BA%E7%A1%80%E5%B7%A5%E5%85%B7/hystrix/1.hystrix-%E7%AE%80%E4%BB%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avator.png">
      <meta itemprop="name" content="Zamperini">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zamperini">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2017/08/12/%E5%9F%BA%E7%A1%80%E5%B7%A5%E5%85%B7/hystrix/1.hystrix-%E7%AE%80%E4%BB%8B/" class="post-title-link" itemprop="url">Hystrix-ç®€ä»‹</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2017-08-12 00:00:00" itemprop="dateCreated datePublished" datetime="2017-08-12T00:00:00+08:00">2017-08-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-02-13 19:59:59" itemprop="dateModified" datetime="2020-02-13T19:59:59+08:00">2020-02-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/hystrix/" itemprop="url" rel="index">
                    <span itemprop="name">hystrix</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>#Hystrix ç®€ä»‹<br>â€œ<strong>Excuse me? å¤´æˆ´é‡‘å†  åŒ—æç†Š??</strong>â€œ<br><img src="/media/15018147277400.jpg" alt="set up-w300"></p>
<blockquote>
<p>Netflix(ä¸–ç•Œæœ€å¤§åœ¨çº¿å½±ç‰‡ç§ŸèµæœåŠ¡å•†)å¼€æºçš„å»¶è¿Ÿå®¹é”™å·¥å…·åŒ…ï¼Œç”¨äºéš”ç¦»åˆ†å¸ƒå¼ç³»ç»Ÿä¹‹é—´çš„ä¾èµ–è®¿é—®ã€‚é˜²æ­¢çº§è”æ•…éšœï¼Œä½¿å¾—å¤æ‚çš„åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨é”™è¯¯ä¸å¯é¿å…çš„æ¡ä»¶ä¸‹ä»å…·æœ‰å¼¹æ€§ï¼Œå…·æœ‰è‡ªæˆ‘ä¿æŠ¤çš„èƒ½åŠ›ã€‚</p>
</blockquote>
<p><a href="https://github.com/Netflix/Hystrix/wiki/FAQ%20:%20General#where-does-the-name-come-from" target="_blank" rel="noopener"><strong>Where does the name from?</strong></a></p>
<p><img src="/media/14980602061637.jpg" alt="set up-w300"></p>
<h2 id="åŠŸèƒ½ï¼š"><a href="#åŠŸèƒ½ï¼š" class="headerlink" title="åŠŸèƒ½ï¼š"></a>åŠŸèƒ½ï¼š</h2><ul>
<li>é˜²æŠ¤å¹¶æ§åˆ¶å› ä¾èµ–ç¬¬ä¸‰æ–¹æœåŠ¡å¯¼è‡´çš„å»¶æ—¶å’Œæ•…éšœï¼›</li>
<li>é˜»æ­¢çº§è”æ•…éšœï¼›</li>
<li>å¿«é€Ÿå¤±è´¥å¹¶ä¸”èƒ½å¿«é€Ÿæ¢å¤ï¼›</li>
<li>æ”¯æŒå¤±è´¥é™çº§å’Œæä¾›ä¼˜é›…çš„æœåŠ¡é™çº§æœºåˆ¶ï¼›</li>
<li>æ”¯æŒè¿‘å®æ—¶ç›‘æ§ã€æŠ¥è­¦ä»¥åŠæ“ä½œæ§åˆ¶ã€‚</li>
</ul>
<h2 id="åº”ç”¨åœºæ™¯ï¼š"><a href="#åº”ç”¨åœºæ™¯ï¼š" class="headerlink" title="åº”ç”¨åœºæ™¯ï¼š"></a>åº”ç”¨åœºæ™¯ï¼š</h2><p>åœ¨å¤æ‚çš„åˆ†å¸ƒå¼ç³»ç»Ÿé‡Œä¼šæœ‰å¾ˆå¤šä¾èµ–ï¼Œæ¯ä¸ªä¾èµ–éƒ½ä¼šä¸å¯é¿å…åœ°åœ¨æŸäº›æ—¶å€™å‘ç”Ÿæ•…éšœã€‚å¦‚æœä¸»åº”ç”¨æ²¡æœ‰éš”ç¦»è¿™äº›æ•…éšœï¼Œé‚£ä¹ˆå°±æœ‰è¢«æ‹–å®çš„é£é™©ã€‚(<em>mmdb</em>å¤§é¢ç§¯è¶…æ—¶å°±æ˜¯æœ€æœ‰è¯´æœåŠ›çš„ğŸŒ°)<br>Hystrixå®˜ç½‘ç»™å‡ºäº†è¿™æ ·ä¸€ä¸ªä¾‹å­ï¼š</p>
<blockquote>
<p>ä¸€ä¸ªåº”ç”¨ä¾èµ–30ä¸ªå¤–éƒ¨æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡çš„å¯ç”¨æ€§ä¸º<code>99.99%</code>ï¼Œé‚£ä¹ˆä¸»åº”ç”¨çš„å¯ç”¨æ€§å³ä¸º<code>99.99^30</code> = <code>99.7%</code><br><code>0.3%</code>çš„æ•…éšœç‡æ„å‘³ç€æ¯æœˆæœ‰2+å°æ—¶çš„æ—¶é—´æœåŠ¡ä¸å¯ç”¨ã€‚å¯ç”¨æ€§æ˜¯ç›¸å½“å·®çš„<br>å½“æœåŠ¡ä¾èµ–æ•°è¶Šå¤šæ—¶ï¼Œæ•´ä½“å¯ç”¨æ€§è¶Šå·®</p>
</blockquote>
<p>æœåŠ¡æ­£å¸¸è¿è¡Œæ—¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º:<br><img src="/media/14980612634741.jpg" alt></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2017/08/12/%E5%9F%BA%E7%A1%80%E5%B7%A5%E5%85%B7/hystrix/1.hystrix-%E7%AE%80%E4%BB%8B/#more" rel="contents">
                é˜…è¯»å…¨æ–‡ &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dorgenjones.github.io/2017/03/14/%E5%9F%BA%E7%A1%80%E5%B7%A5%E5%85%B7/log/4.log4j2%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%A4%84%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avator.png">
      <meta itemprop="name" content="Zamperini">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zamperini">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2017/03/14/%E5%9F%BA%E7%A1%80%E5%B7%A5%E5%85%B7/log/4.log4j2%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%A4%84%E7%90%86/" class="post-title-link" itemprop="url">Log4j2 æ ¼å¼åŒ–å¤„ç†</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2017-03-14 00:00:00" itemprop="dateCreated datePublished" datetime="2017-03-14T00:00:00+08:00">2017-03-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-02-13 20:02:53" itemprop="dateModified" datetime="2020-02-13T20:02:53+08:00">2020-02-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/log4j/" itemprop="url" rel="index">
                    <span itemprop="name">log4j</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="PatternFormatter"><a href="#PatternFormatter" class="headerlink" title="PatternFormatter"></a>PatternFormatter</h1><h2 id="LogEventPatternConverter"><a href="#LogEventPatternConverter" class="headerlink" title="LogEventPatternConverter"></a>LogEventPatternConverter</h2><pre><code>### - LevelPatternConverter
### - ThreadPatternConvter
### - DatePatternConverter</code></pre><h2 id="FormattingInfo"><a href="#FormattingInfo" class="headerlink" title="FormattingInfo"></a>FormattingInfo</h2><h1 id="PatternLayout"><a href="#PatternLayout" class="headerlink" title="PatternLayout"></a>PatternLayout</h1><blockquote>
<p>åœ¨å¯¹PatternLayoutçš„patternå­—æ®µè¿›è¡Œè§£æï¼ˆPatternParserçš„parse(final String pattern, final boolean alwaysWriteExceptions,final boolean noConsoleNoAnsi)ä¸­è¿›è¡Œï¼‰æ—¶ï¼Œä¼šç”Ÿæˆ List<patternformatter> formatters<br>PatternFormatter(LogEventPatternConverter,FormattingInfo) å…¶ä¸­LogEventPatternConverterç”¨æ¥å°†æ—¥å¿—äº‹ä»¶LogEventè½¬æ¢ä¸ºæŒ‡å®šæ ¼å¼çš„å­—ç¬¦ä¸²å¹¶è¿½åŠ åˆ°è¾“å‡ºå­—ç¬¦ä¸²åã€‚</patternformatter></p>
</blockquote>
<h2 id="æ’ä»¶çš„åˆå§‹åŒ–å…¥å£åœ¨"><a href="#æ’ä»¶çš„åˆå§‹åŒ–å…¥å£åœ¨" class="headerlink" title="æ’ä»¶çš„åˆå§‹åŒ–å…¥å£åœ¨:"></a>æ’ä»¶çš„åˆå§‹åŒ–å…¥å£åœ¨:</h2><blockquote>
<p>PluginManager.collectPluginsé‡Œï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªPluginRegistryå•ä¾‹ï¼Œå…¶<code>decodeCacheFiles</code>æ–¹æ³•ç”¨äºä»META-INF/org/apache/logging/log4j/core/config/plugins/Log4j2Plugins.datæ–‡ä»¶ä¸­åŠ è½½å¹¶è§£ææ’ä»¶å¯¹è±¡ï¼Œå¹¶æŒ‰ç±»åˆ«å­˜å‚¨ã€‚ç›®å‰å…±æœ‰6ä¸­ç±»å‹æ’ä»¶ï¼šconverter,lookup,core,configurationfactory,fileconverter,typeconverter</p>
</blockquote>
<h2 id="PatternLayoutçš„å¤„ç†"><a href="#PatternLayoutçš„å¤„ç†" class="headerlink" title="PatternLayoutçš„å¤„ç†:"></a>PatternLayoutçš„å¤„ç†:</h2><blockquote>
<p>åœ¨å®ä¾‹åŒ–PatternFormatteræ—¶ï¼ŒåŒæ—¶ä¼šé€šè¿‡PatternParserå°† å­—ç¬¦ä¸²è½¬æ¢æˆè½¬æ¢å™¨åˆ—è¡¨<code>PatternFormater(LogEventPatternConverter,FormattingInfo)</code>ã€‚LogEventPatternConverteræ˜¯è½¬æ¢ç±»æ’ä»¶çš„æŠ½è±¡ç±»ã€‚<br>ä¸‹å›¾æ¼”ç¤ºçš„å°±æ˜¯å…¶å¯¹åº”å…³ç³»ï¼š<br><img src="/media/14933065402517.jpg" alt="set up-w888"></p>
</blockquote>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2017/03/14/%E5%9F%BA%E7%A1%80%E5%B7%A5%E5%85%B7/log/4.log4j2%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%A4%84%E7%90%86/#more" rel="contents">
                é˜…è¯»å…¨æ–‡ &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dorgenjones.github.io/2017/03/13/%E5%9F%BA%E7%A1%80%E5%B7%A5%E5%85%B7/log/3.log4j2%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avator.png">
      <meta itemprop="name" content="Zamperini">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zamperini">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2017/03/13/%E5%9F%BA%E7%A1%80%E5%B7%A5%E5%85%B7/log/3.log4j2%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" class="post-title-link" itemprop="url">Log4j2æºç è§£æ</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2017-03-13 00:00:00" itemprop="dateCreated datePublished" datetime="2017-03-13T00:00:00+08:00">2017-03-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-02-13 20:02:41" itemprop="dateModified" datetime="2020-02-13T20:02:41+08:00">2020-02-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/log4j/" itemprop="url" rel="index">
                    <span itemprop="name">log4j</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Log4j2-æºç æµ…æ"><a href="#Log4j2-æºç æµ…æ" class="headerlink" title="Log4j2 æºç æµ…æ"></a>Log4j2 æºç æµ…æ</h1><p>[TOC]</p>
<p>ä»‹ç»Log4j2çš„åŸç†ä¹‹å‰ï¼Œå›é¡¾ä¸‹ä¹‹å‰é…ç½®æ–‡ä»¶ä¸­æåˆ°çš„å‡ ä¸ªæ¦‚å¿µï¼šConfigurationã€LoggerConfigã€Loggerã€Appenderã€Layoutã€Filterã€‚Log4j2çš„å®˜ç½‘ä¸Šç»™å‡ºäº†ç±»å›¾ï¼Œèƒ½æ¸…æ™°åœ°çœ‹æ¸…æ¥šå®ƒä»¬ä¹‹é—´çš„å…³è”ã€‚<br>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºLoggerContextã€Configurationæ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œåœ¨ä¸€èˆ¬çš„åº”ç”¨ä¸­é€šå¸¸ä¹Ÿéƒ½åªå­˜åœ¨ä¸€ä¸ªå®ä¾‹(Share one ClassLoader(<strong>Standalone Applicationã€Web Applicationã€Java EE Applicationsã€â€Sharedâ€ Web Applications and REST Service Containers</strong>)ï¼Œ<strong>Not</strong> <strong>OSGi Applications</strong> <a href="http://logging.apache.org/log4j/2.x/manual/logsep.html" target="_blank" rel="noopener">Logging Separation</a>)ã€‚</p>
<ol>
<li><strong>LoggerContext</strong>: æ•´ä¸ªæ—¥å¿—ç³»ç»Ÿçš„<strong>é”šç‚¹</strong>ï¼ˆæ‰¿è½½å…¨å±€æ—¥å¿—ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼‰ï¼Œç±»ä¼¼äºSpringçš„WebApplicationContext</li>
<li><strong>Configuration</strong>: <strong>å…¨å±€é…ç½®ä¿¡æ¯</strong>ï¼Œæ¯ä¸ªLoggerContextå¯¹åº”ä¸€ä¸ªConfiguration</li>
<li><strong>Appender</strong>: è¿½åŠ å™¨ï¼Œå¯¹åº”é…ç½®æ–‡ä»¶ä¸­çš„<code>&lt;Appenders&gt;</code>ä¸‹å®šä¹‰çš„Appenderï¼Œå®šä¹‰æ—¥å¿—è¾“å‡ºä½ç½®ä»¥åŠæ—¥å¿—è¾“å‡ºæ ¼å¼ï¼Œã€‚ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰Appenderï¼Œåªéœ€ç»§æ‰¿AbstractAppenderå¹¶å®ç°append(LogEvent)æ–¹æ³•ã€‚<ul>
<li><strong>Layout</strong>: å®šä¹‰æ—¥å¿—çš„è¾“å‡ºæ ¼å¼</li>
</ul>
</li>
<li><strong>Filter</strong>: <strong>è¿‡æ»¤å™¨</strong>ï¼Œåœ¨æ•´ä¸ªæ—¥å¿—ç³»ç»Ÿçš„ç±»å›¾ä¸­ï¼Œå¤šä¸ªåœ°æ–¹åº”ç”¨ã€‚èµ·åˆ°ä¸€ä¸ªè¿‡æ»¤çš„ä½œç”¨ï¼Œç”¨äºè¿‡æ»¤ç‰¹å®šæ—¥å¿—çº§åˆ«çš„æ—¥å¿—äº‹ä»¶ã€‚æœ‰å¤šä¸ªåœ°æ–¹å¼•ç”¨<code>Filter</code>ï¼šæ—¥å¿—äº‹ä»¶è¿›å…¥LoggerConfigä¹‹å‰ï¼›è¿›å…¥LoggerConfigåè°ƒç”¨ä»»ä½•Appenderä¹‹å‰ï¼›è¿›å…¥LoggerConfigåè°ƒç”¨ç‰¹æ®Šçš„Appenderä¹‹å‰ï¼›æ¯ä¸ªAppenderå†…éƒ¨ã€‚</li>
<li><strong>LoggerConfig</strong>: çœŸæ­£çš„æ—¥å¿—æ“ä½œå®ä½“ï¼Œå¯¹åº”é…ç½®æ–‡ä»¶ä¸­çš„<code>&lt;Logger&gt;</code>ä¸‹å®šä¹‰çš„Loggerã€‚å«æœ‰å…¨å±€å”¯ä¸€æ ‡è¯†ï¼ˆåç§°ï¼‰ï¼Œä¸€èˆ¬å¯¹åº”çš„æ˜¯ä¸€ä¸ªåŒ…ç›®å½•åç§°ã€‚</li>
<li><strong>Logger</strong>: å£³ï¼Œæ¯ä¸ªLoggerå†…éƒ¨éƒ½å¯¹åº”ä¸€ä¸ªLoggerConfigï¼ˆé€šè¿‡åç§°æ¥å¯¹åº”ï¼‰ã€‚å¯¹æ—¥å¿—äº‹ä»¶çš„æ“ä½œï¼Œéƒ½äº¤ç”±å…¶å¯¹åº”çš„LoggerConfigè¿›è¡Œå¤„ç†<br><img src="/media/14930134238097.jpg" alt="set up-w666"></li>
</ol>
<ul>
<li>åœ¨ä½¿ç”¨æ—¥å¿—ç³»ç»Ÿå‰ï¼Œé¦–å…ˆéœ€è¦åˆå§‹åŒ–æ—¥å¿—ç³»ç»Ÿï¼šè§£ææ—¥å¿—é…ç½®ä¿¡æ¯<code>Configuration</code>ï¼Œå»ºç«‹æ—¥å¿—ä¸Šä¸‹æ–‡<code>LoggerContext</code>ï¼ˆå±æ€§ã€Appenderã€LogerConfigâ€¦ï¼‰</li>
<li>ç»™å®šnameè·å–æ—¥å¿—å¯¹è±¡Loggeræ—¶ï¼Œ<code>LoggerContext</code>ç»“åˆä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè¿”å›ä¸€ä¸ªç»‘å®šäº†ç‰¹å®šåç§°çš„<code>LoggerConfig</code>çš„<code>Loger</code></li>
<li>åœ¨æ‰§è¡Œæ—¥å¿—æ“ä½œæ—¶ï¼Œä¼šç»è¿‡å¤šå±‚è¿‡æ»¤(Filter)ï¼Œå¹¶ä¸”çœŸæ­£çš„æ—¥å¿—æ“ä½œç”±LoggerConfigæ¥å¤„ç†ã€‚</li>
</ul>
<p>å› æ­¤ä¸‹é¢ï¼Œå°†ä»<strong>è¿™ä¸‰æ–¹é¢</strong>æ¥åˆ†ææ—¥å¿—ç³»ç»Ÿã€‚1. æ—¥å¿—ç³»ç»Ÿçš„åˆå§‹åŒ–ï¼›2.è·å–æ—¥å¿—å¯¹è±¡ï¼›3.æ—¥å¿—æ“ä½œè¿‡ç¨‹ã€‚å…¶ä¸­ï¼Œæ—¥å¿—ç³»ç»Ÿçš„åˆå§‹åŒ–è¾ƒå…¶ä»–ä¸¤éƒ¨åˆ†ç¨å¤æ‚ã€‚</p>
<h2 id="1-æ—¥å¿—ç³»ç»Ÿçš„åˆå§‹åŒ–è¿‡ç¨‹ï¼Œè·å–LoggerContext"><a href="#1-æ—¥å¿—ç³»ç»Ÿçš„åˆå§‹åŒ–è¿‡ç¨‹ï¼Œè·å–LoggerContext" class="headerlink" title="1. æ—¥å¿—ç³»ç»Ÿçš„åˆå§‹åŒ–è¿‡ç¨‹ï¼Œè·å–LoggerContext"></a>1. æ—¥å¿—ç³»ç»Ÿçš„åˆå§‹åŒ–è¿‡ç¨‹ï¼Œè·å–LoggerContext</h2><p>åˆå§‹åŒ–çš„è¿‡ç¨‹å…³é”®æ˜¯ åŠ è½½å¹¶è§£æé…ç½®æ–‡ä»¶ï¼Œå»ºç«‹æ—¥å¿—ä¸Šä¸‹æ–‡ã€‚<br>åˆå§‹åŒ–è¿‡ç¨‹çš„æ—¶åºå›¾ï¼š<br><img src="/media/log%E5%88%9D%E5%A7%8B%E5%8C%96%E6%97%B6%E5%BA%8F%E5%9B%BE.png" alt="logåˆå§‹åŒ–æ—¶åºå›¾"></p>
<p>å½“åº”ç”¨é¦–æ¬¡è°ƒåŠ¨<code>LogManager.getLogger</code>æ–¹æ³•æ—¶ï¼Œè§¦å‘æ—¥å¿—ç³»ç»Ÿçš„åˆå§‹åŒ–ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Logger <span class="title">getLogger</span><span class="params">(<span class="keyword">final</span> Class&lt;?&gt; clazz)</span> </span>&#123;</span><br><span class="line">   ...</span><br><span class="line">   <span class="comment">//è·å–LoggerContextï¼Œé€šè¿‡å…¶è·å–æŒ‡å®šç±»åç§°çš„Logger</span></span><br><span class="line">   <span class="keyword">return</span> getContext(clazz.getClassLoader(), <span class="keyword">false</span>).getLogger(clazz.getName());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2017/03/13/%E5%9F%BA%E7%A1%80%E5%B7%A5%E5%85%B7/log/3.log4j2%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/#more" rel="contents">
                é˜…è¯»å…¨æ–‡ &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dorgenjones.github.io/2017/03/12/%E5%9F%BA%E7%A1%80%E5%B7%A5%E5%85%B7/log/2.log4j2%E9%85%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avator.png">
      <meta itemprop="name" content="Zamperini">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zamperini">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2017/03/12/%E5%9F%BA%E7%A1%80%E5%B7%A5%E5%85%B7/log/2.log4j2%E9%85%8D%E7%BD%AE/" class="post-title-link" itemprop="url">Log4j2é…ç½®æ–‡ä»¶&æè¿°</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2017-03-12 00:00:00" itemprop="dateCreated datePublished" datetime="2017-03-12T00:00:00+08:00">2017-03-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-02-13 20:02:17" itemprop="dateModified" datetime="2020-02-13T20:02:17+08:00">2020-02-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/log4j/" itemprop="url" rel="index">
                    <span itemprop="name">log4j</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Log4j2-é…ç½®æ–‡ä»¶åŠæè¿°"><a href="#Log4j2-é…ç½®æ–‡ä»¶åŠæè¿°" class="headerlink" title="Log4j2 é…ç½®æ–‡ä»¶åŠæè¿°"></a>Log4j2 é…ç½®æ–‡ä»¶åŠæè¿°</h1><p>å‰é¢ä»‹ç»Java Logçš„æ€»ä½“æƒ…å†µï¼Œä»¥åŠä¸¤ä¸ªæ—¥å¿—æ¡†æ¶å’Œå…·ä½“æ—¥å¿—å®ç°æ¡†æ¶é—´çš„æ¡¥æ¥ã€‚æœ¬ç« ä¸»è¦ä»‹ç»æ—¥å¸¸å·¥ä½œä¸­ç”¨çš„æ¯”è¾ƒå¤šçš„Log4j2çš„é…ç½®ä¿¡æ¯ä»¥åŠè§£é‡Šã€‚</p>
<h2 id="1-é…ç½®æ–‡ä»¶è§£æ"><a href="#1-é…ç½®æ–‡ä»¶è§£æ" class="headerlink" title="1. é…ç½®æ–‡ä»¶è§£æ"></a>1. é…ç½®æ–‡ä»¶è§£æ</h2><h3 id="1-åŒæ­¥æ¨¡å¼"><a href="#1-åŒæ­¥æ¨¡å¼" class="headerlink" title="1. åŒæ­¥æ¨¡å¼"></a>1. åŒæ­¥æ¨¡å¼</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    å…¨å±€é…ç½®</span></span><br><span class="line"><span class="comment">    status : è¿™ä¸ªç”¨äºè®¾ç½®log4j2è‡ªèº«å†…éƒ¨çš„ä¿¡æ¯è¾“å‡º,å¯ä»¥ä¸è®¾ç½®,å½“è®¾ç½®æˆtraceæ—¶,ä¼šçœ‹åˆ°log4j2å†…éƒ¨å„ç§è¯¦ç»†è¾“å‡º</span></span><br><span class="line"><span class="comment">    monitorInterval : Log4jèƒ½å¤Ÿè‡ªåŠ¨æ£€æµ‹ä¿®æ”¹é…ç½®æ–‡ä»¶å’Œé‡æ–°é…ç½®æœ¬èº«, è®¾ç½®é—´éš”ç§’æ•°ã€‚</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Configuration</span> <span class="attr">status</span>=<span class="string">"WARN"</span> <span class="attr">monitorInterval</span>=<span class="string">"1000"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Properties</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®æ—¥å¿—ç›®å½• --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Property</span> <span class="attr">name</span>=<span class="string">"LOG_HOME"</span>&gt;</span>./logs<span class="tag">&lt;/<span class="name">Property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Properties</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ—¥å¿—è¾“å‡ºåœ°å€--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Appenders</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--è¾“å‡ºæ§åˆ¶å°--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Console</span> <span class="attr">name</span>=<span class="string">"Console"</span> <span class="attr">target</span>=<span class="string">"SYSTEM_OUT"</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- æ—¥å¿—æ ¼å¼ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">"[%level][%date&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;][%thread][%class][%method][%line]:%message%n"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Console</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">RollingRandomAccessFile</span> <span class="attr">name</span>=<span class="string">"infoLog"</span> <span class="attr">fileName</span>=<span class="string">"$&#123;LOG_HOME&#125;/info.log"</span></span></span><br><span class="line"><span class="tag">                                 <span class="attr">filePattern</span>=<span class="string">"$&#123;LOG_HOME&#125;/info.%d&#123;yyyy-MM-dd&#125;.log.gz"</span> <span class="attr">append</span>=<span class="string">"true"</span>&gt;</span><span class="comment">&lt;!--å‹ç¼©æ–‡ä»¶å--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">"[%level][%date&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;][%thread][%class][%method][%line]:%message%n"</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                 %c&#123;precision&#125; | %logger&#123;precision&#125; : name of the logger</span></span><br><span class="line"><span class="comment">                 %class&#123;precision&#125; | %C&#123;precision&#125;: class name of the caller</span></span><br><span class="line"><span class="comment">                 %date&#123;pattern&#125; | %d&#123;pattern&#125; :the date of the logging event</span></span><br><span class="line"><span class="comment">                 %L | %line:line number</span></span><br><span class="line"><span class="comment">                 %level : the level of the logging event</span></span><br><span class="line"><span class="comment">                 %m&#123;nolookups&#125;&#123;ansi&#125; | %msg&#123;nolookups&#125;&#123;ansi&#125; | %message&#123;nolookups&#125;&#123;ansi&#125;:application supplied message</span></span><br><span class="line"><span class="comment">                 %method | %M: method name where the logging request</span></span><br><span class="line"><span class="comment">                 %t | %tn | %thread | %threadName :name of the thread</span></span><br><span class="line"><span class="comment">                 %n :</span></span><br><span class="line"><span class="comment">             --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Filters</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ThresholdFilter</span> <span class="attr">level</span>=<span class="string">"error"</span> <span class="attr">onMatch</span>=<span class="string">"DENY"</span> <span class="attr">onMismatch</span>=<span class="string">"NEUTRAL"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ThresholdFilter</span> <span class="attr">level</span>=<span class="string">"warn"</span> <span class="attr">onMatch</span>=<span class="string">"DENY"</span> <span class="attr">onMismatch</span>=<span class="string">"NEUTRAL"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ThresholdFilter</span> <span class="attr">level</span>=<span class="string">"info"</span> <span class="attr">onMatch</span>=<span class="string">"ACCEPT"</span> <span class="attr">onMismatch</span>=<span class="string">"DENY"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ThresholdFilter</span> <span class="attr">level</span>=<span class="string">"debug"</span> <span class="attr">onMatch</span>=<span class="string">"ACCEPT"</span> <span class="attr">onMismatch</span>=<span class="string">"DENY"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">Filters</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Policies</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                     TimeBased Triggering Policy: The policy to use to determine if a rollover should occur.</span></span><br><span class="line"><span class="comment">                    intervalå•ä½ä¸filePatternç›¸å…³ yyyy-MM-dd ä¸€å¤©ä¸€ä¸ªæ–‡ä»¶, yyyy-MM-dd-HH æ¯å°æ—¶ä¸€ä¸ªæ–‡ä»¶</span></span><br><span class="line"><span class="comment">                    åŸºäºæ—¶é—´çš„è§¦å‘ç­–ç•¥ã€‚è¯¥ç­–ç•¥ä¸»è¦æ˜¯å®Œæˆå‘¨æœŸæ€§çš„logæ–‡ä»¶å°å­˜å·¥ä½œã€‚æœ‰ä¸¤ä¸ªå‚æ•°ï¼š</span></span><br><span class="line"><span class="comment">                    intervalï¼Œintegerå‹ï¼ŒæŒ‡å®šä¸¤æ¬¡å°å­˜åŠ¨ä½œä¹‹é—´çš„æ—¶é—´é—´éš”ã€‚å•ä½:ä»¥æ—¥å¿—çš„å‘½åç²¾åº¦æ¥ç¡®å®šå•ä½</span></span><br><span class="line"><span class="comment">                    modulateï¼Œbooleanå‹ï¼Œè¯´æ˜æ˜¯å¦å¯¹å°å­˜æ—¶é—´è¿›è¡Œè°ƒåˆ¶ã€‚è‹¥modulate=trueï¼Œåˆ™å°å­˜æ—¶é—´å°†ä»¥0ç‚¹ä¸ºè¾¹ç•Œè¿›è¡Œåç§»è®¡ç®—ã€‚</span></span><br><span class="line"><span class="comment">                --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">SizeBasedTriggeringPolicy</span> <span class="attr">size</span>=<span class="string">"100 MB"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">Policies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">RollingRandomAccessFile</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">RollingRandomAccessFile</span> <span class="attr">name</span>=<span class="string">"errorLog"</span> <span class="attr">fileName</span>=<span class="string">"$&#123;LOG_HOME&#125;/error.log"</span></span></span><br><span class="line"><span class="tag">                                 <span class="attr">filePattern</span>=<span class="string">"$&#123;LOG_HOME&#125;/error.%d&#123;yyyy-MM-dd&#125;.log.gz"</span> <span class="attr">append</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Filters</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ThresholdFilter</span> <span class="attr">level</span>=<span class="string">"ERROR"</span> <span class="attr">onMatch</span>=<span class="string">"ACCEPT"</span> <span class="attr">onMismatch</span>=<span class="string">"DENY"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">Filters</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">"[%level][%date&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;][%thread][%class][%method][%line]:%message%n"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Policies</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">TimeBasedTriggeringPolicy</span> <span class="attr">interval</span>=<span class="string">"1"</span> <span class="attr">modulate</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">Policies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">RollingRandomAccessFile</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Appenders</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--æ—¥å¿—é…ç½®--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Loggers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"experiment"</span> <span class="attr">level</span>=<span class="string">"info"</span> <span class="attr">additivity</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"infoLog"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"errorLog"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"Console"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"experiment.test"</span> <span class="attr">level</span>=<span class="string">"warn"</span> <span class="attr">additivity</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"infoLog"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"errorLog"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"Console"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"algorithm"</span> <span class="attr">level</span>=<span class="string">"info"</span> <span class="attr">additivity</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"infoLog"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">"Console"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®æ—¥å¿—çš„æ ¹èŠ‚ç‚¹ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Root</span> <span class="attr">level</span>=<span class="string">"warn"</span> <span class="attr">includeLocation</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">"errorLog"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">"Console"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Root</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Loggers</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">Configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="2-å…¨å¼‚æ­¥æ¨¡å¼"><a href="#2-å…¨å¼‚æ­¥æ¨¡å¼" class="headerlink" title="2. å…¨å¼‚æ­¥æ¨¡å¼"></a>2. å…¨å¼‚æ­¥æ¨¡å¼</h3><ol>
<li>åªéœ€è¦å°†<strong>ç³»ç»Ÿå±æ€§</strong><code>Log4jContextSelector</code>è®¾ç½®ä¸º<code>AsyncLoggerContextSelector</code></li>
<li>åœ¨é…ç½®å±æ€§æ–‡ä»¶<code>log4j2.component.properties</code>ä¸­é…ç½®<code>Log4jContextSelector</code>ä¸º<code>AsyncLoggerContextSelector</code></li>
</ol>
<h3 id="3-æ··åˆæ¨¡å¼"><a href="#3-æ··åˆæ¨¡å¼" class="headerlink" title="3.æ··åˆæ¨¡å¼"></a>3.æ··åˆæ¨¡å¼</h3><p>todo ä¿®æ”¹<br>ä¸éœ€è¦æ”¹ç³»ç»Ÿå±æ€§æˆ–è€…å¼•å…¥å±æ€§é…ç½®æ–‡ä»¶ï¼Œåªéœ€è¦å°†ç›¸åº”çš„<code>Loger</code>æ¢æˆ<code>AsyncLoger</code>ã€‚</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">logers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">AsyncLogger</span> <span class="attr">name</span>=<span class="string">"experiment.test"</span> <span class="attr">level</span>=<span class="string">"trace"</span> <span class="attr">includeLocation</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">"warnLog"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">AsyncLogger</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">logers</span>&gt;</span></span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2017/03/12/%E5%9F%BA%E7%A1%80%E5%B7%A5%E5%85%B7/log/2.log4j2%E9%85%8D%E7%BD%AE/#more" rel="contents">
                é˜…è¯»å…¨æ–‡ &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/10/"><i class="fa fa-angle-left" aria-label="ä¸Šä¸€é¡µ"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/12/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Zamperini"
      src="/images/avator.png">
  <p class="site-author-name" itemprop="name">Zamperini</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">56</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">23</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/DorgenJones" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;DorgenJones" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:dblpfilter@163.com" title="E-Mail â†’ mailto:dblpfilter@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/1938368215" title="Weibo â†’ https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;1938368215" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i>Weibo</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zamperini</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> å¼ºåŠ›é©±åŠ¨ v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">ä¸»é¢˜ â€“ <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.7.1
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
